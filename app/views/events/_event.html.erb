<div class="row mt-5" id="<%= dom_id event %>">
  <div class="col-md-8 ps-4">
    <h1 class="mb-3"><%= event.event_name %></h1>
    <ul class="ps-0 mt-4" style="list-style: none">
      <% if event.event_time? %>
      <li>
        <div class="mt-3">
          <span>
            <i class="bi-clock-fill me-2"></i>
            <%= event.event_date_and_time %>
          </span>
        </div>
      </li>
      <% end %>
      <li>
        <div class="mt-3">
          <span>
            <i class="bi-geo-alt-fill me-2"></i>
            <% if @event.location.present? %>
              <%= @event.location.full_address %>
            <% else %>
              Virtual
            <% end %>
          </span>
        </div>
      </li>
    </ul>
    <hr class="my-5">
    <div class="mb-5">
      <h4>Event Description</h4>
      <p><%= event.event_description %></p>
    </div>
    <div class="mb-5">
      <h4>Location</h4>
      <iframe
        width=100%
        height="450"
        style="border:0"
        loading="lazy"
        allowfullscreen
        referrerpolicy="no-referrer-when-downgrade"
        src="https://www.google.com/maps/embed/v1/place?key=AIzaSyCCcEd-SxyWVywZz9nMTJBiowQh8l1RYRQ&q=4400+University+Dr">
      </iframe>
    </div>
  </div>

  <div class="col-md-4">
    <div class="d-grid col-8 mx-auto py-2">
      <!-- Event Registration-->
      <% if current_user.id != @event.user_id %>
        <button type="button" class="btn btn-success btn-lg" title="Register for this event" data-bs-toggle="modal" data-bs-target="#eventSignUp">
          Register
        </button>

        <div class="modal fade" id="eventSignUp" tabindex="-1" role="dialog" aria-labelledby="eventSignUpConfirmation" aria-hidden="true">
          <div class="modal-dialog" role="document">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title" id="eventSignUpConfirmation">Confirmation</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
              </div>
              <div class="modal-body">
                Would you like to register for this event?
              </div>
              <div class="modal-footer">
                <button type="button" class="btn btn-light" data-bs-dismiss="modal">Let me rethink</button>
                <%= link_to "Register", events_path, class: "btn btn-success" %>
              </div>
            </div>
          </div>
        </div>
      <% else %>
        <!-- Event Edit -->
        <div class="mb-5">
          <span class="d-flex justify-content-end">
            <%= link_to edit_event_path(@event), class: "btn btn-outline-dark", title: "Edit this event" do %>
              <i class="bi bi-pencil-square"></i>
            <% end %>
          </span>
        </div>
      <% end %>
      <br>

      <span class="d-flex justify-content-center">
        <!-- Event Flagging -->
        <% if current_user.id != @event.user_id %>
          <% if @event.flagged %>
            <button type="button" class="btn btn-danger rounded-circle" title="Unflag this event" data-bs-toggle="modal" data-bs-target="#eventFlag">
          <% else %>
            <button type="button" class="btn btn-outline-danger rounded-circle" title="Flag this event" data-bs-toggle="modal" data-bs-target="#eventFlag">
          <% end %>
            <i class="bi-flag-fill"></i>
          </button>

          <div class="modal fade" id="eventFlag" tabindex="-1" role="dialog" aria-labelledby="eventFlagConfirmation" aria-hidden="true">
            <div class="modal-dialog" role="document">
              <div class="modal-content">
                <div class="modal-header">
                  <h5 class="modal-title" id="eventFlagConfirmation">Confirmation</h5>
                  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                  <% if @event.flagged %>
                    Are you sure you want to unflag this event?
                  <% else %>
                    Are you sure you want to flag this event?
                  <% end %>
                </div>
                <div class="modal-footer">
                  <button type="button" class="btn btn-light" data-bs-dismiss="modal">Let me rethink</button>
                  <% if @event.flagged %>
                    <%= link_to "Unflag Event", flag_path(@event.id, flag: false), data: { "turbo-method": :patch }, class: "btn btn-danger" %>
                  <% else %>
                    <%= link_to "Flag Event", flag_path(@event.id, flag: true), data: { "turbo-method": :patch }, class: "btn btn-danger" %>
                  <% end %>
                </div>
              </div>
            </div>
          </div>
        <% end %>
      </span>
    </div>
    <div class="card shadow p-3 mb-5 bg-body-tertiary">
      <div class="card-body">
        <h5 class="card-title">Host:</h5>
        <span>
          <%= @event.user.full_name %>
        </span>
      </div>
      <hr>
      <div class="card-body">
        <h5 class="card-title">Attendee(s):</h5>
        <span>
          <ul>
            <% @event.users.order(:created_at).each do |attendee| %>
              <li><%= attendee.full_name %></li>
            <% end %>
          <ul>
        </span>
      </div>
    </div>
  </div>
</div>
